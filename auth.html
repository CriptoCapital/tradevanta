<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>TradeVanta — Login / Signup</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{--bg:#0f1720;--card:#0d1116;--muted:#9aa6b2;--accent:#00c2a8;--strong:#e6eef3}
  html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;color:var(--strong);background:linear-gradient(180deg,var(--bg),#071018)}
  .center{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:18px}
  .box{width:980px;display:grid;grid-template-columns:1fr 420px;gap:24px;align-items:center}
  .left{padding:24px}
  .brand{display:flex;align-items:center;gap:10px}
  .logo{width:44px;height:44px;border-radius:8px;background:linear-gradient(135deg,var(--accent),#00ffd5);display:flex;align-items:center;justify-content:center;font-weight:700;color:#022}
  .card{background:var(--card);padding:18px;border-radius:12px}
  .form{display:flex;flex-direction:column;gap:10px;margin-top:6px}
  input,select{background:#071018;border:1px solid rgba(255,255,255,0.04);color:var(--strong);padding:12px;border-radius:8px;outline:none}
  .row{display:flex;gap:10px}
  .btn{padding:12px;border-radius:10px;border:none;cursor:pointer;font-weight:700}
  .btn-primary{background:var(--accent);color:#022}
  .toggle{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);padding:8px;border-radius:999px;cursor:pointer}
  .muted{color:var(--muted);font-size:13px}
  .small{font-size:13px;color:var(--muted)}
  .error{color:#ff7a7a;font-size:13px}
</style>
</head>
<body>
  <div class="center">
    <div class="box">
      <div class="left">
        <div class="brand">
          <div class="logo">TV</div>
          <div>
            <div style="font-weight:700">TradeVanta</div>
            <div class="small">Join and start trading with a live demo portfolio</div>
          </div>
        </div>

        <div style="height:18px"></div>

        <div class="card">
          <div style="font-size:14px;color:var(--muted)">Why TradeVanta?</div>
          <ul style="color:var(--muted);line-height:1.6;margin-top:12px">
            <li>Simple, fast UI</li>
            <li>Real-time charts and currency switching</li>
            <li>Supabase auth + persistent wallet & transactions</li>
          </ul>
        </div>
      </div>

      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
          <div style="font-weight:700">Sign in</div>
          <button id="toggle" class="toggle">Switch to Sign up</button>
        </div>

        <div id="auth-form" class="form">
          <input id="email" type="email" placeholder="Email" />
          <input id="password" type="password" placeholder="Password" />
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div class="small muted">By continuing you accept the terms.</div>
            <button id="submitBtn" class="btn btn-primary">Sign in</button>
          </div>
          <div id="err" class="error" style="display:none"></div>
          <div style="height:8px"></div>
          <div style="display:flex;gap:8px;margin-top:8px">
            <button id="google" class="btn" style="background:#fff;color:#04161a">Sign in with Google</button>
            <button id="demo" class="btn" style="background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted)">Try demo</button>
          </div>
        </div>
      </div>
    </div>
  </div>

<!-- Supabase and helpers -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/dist/supabase.min.js"></script>
<script>
  // Replace with your Supabase project values:
  const SUPABASE_URL = 'https://kmjgyqqbqcxwpavwgnsu.supabase.co';
  const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imttamd5cXFicWN4d3BhdndnbnN1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkxNTIzNjMsImV4cCI6MjA3NDcyODM2M30.uHWMB_DeQn4nQ-MWcwEKVhnskA_K1AlGoAacmxVu3b0';

  const supabase = supabaseLib.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

  // UI elements
  const toggle = document.getElementById('toggle');
  const submitBtn = document.getElementById('submitBtn');
  const demoBtn = document.getElementById('demo');
  const googleBtn = document.getElementById('google');
  const errEl = document.getElementById('err');

  let isSignup = false;
  toggle.addEventListener('click', () => {
    isSignup = !isSignup;
    toggle.textContent = isSignup ? 'Switch to Sign in' : 'Switch to Sign up';
    submitBtn.textContent = isSignup ? 'Create account' : 'Sign in';
  });

  submitBtn.addEventListener('click', async () => {
    const email = document.getElementById('email').value.trim();
    const password = document.getElementById('password').value.trim();
    errEl.style.display = 'none';
    try{
      if(isSignup){
        const { data, error } = await supabase.auth.signUp({ email, password });
        if(error) throw error;
        // create profile after signup — will exist after confirmation
        // Redirect to dashboard (or wait for email confirmation depending on supabase settings)
        window.location.href = 'dashboard.html';
      } else {
        const { data, error } = await supabase.auth.signInWithPassword({ email, password });
        if(error) throw error;
        window.location.href = 'dashboard.html';
      }
    }catch(e){
      errEl.style.display = 'block';
      errEl.textContent = e.message || 'Something went wrong';
    }
  });

  googleBtn.addEventListener('click', async () => {
    await supabase.auth.signInWithOAuth({ provider: 'google' });
  });

  demoBtn.addEventListener('click', async () => {
    // Create a random demo session using anon sign-up stub (not persisted)
    // We'll store a demo token in localStorage to simulate a logged-in demo user.
    localStorage.setItem('tradevanta_demo', JSON.stringify({ created:Date.now() }));
    window.location.href = 'dashboard.html';
  });

  // If already signed in, redirect
  (async function(){
    const { data } = await supabase.auth.getSession();
    if(data?.session) window.location.href = 'dashboard.html';
  })();
</script>
</body>
</html>
